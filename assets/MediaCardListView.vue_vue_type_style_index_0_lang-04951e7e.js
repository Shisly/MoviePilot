import{d as V,r as s,e as b,o as r,c as l,j as n,m as v,au as L,W as d,i as g,M as h,a1 as k,a2 as B,f as x}from"./index-22247931.js";import{_ as M}from"./MediaCard.vue_vue_type_style_index_0_lang-7b9a4811.js";import{_ as S}from"./NoDataFound.vue_vue_type_style_index_0_lang-85316a43.js";const D={key:0,class:"mt-12 w-full text-center text-gray-500 text-sm flex flex-col items-center"},H={key:0,class:"grid gap-4 grid-media-card mx-3",tabindex:"0"},N=V({__name:"MediaCardListView",props:{apipath:String,params:Object},setup(y){const i=y;function p(){return document.body.scrollHeight-(window.innerHeight||document.documentElement.clientHeight)>2}const c=s(1),u=s(!1),o=s(!1),a=s([]),t=s([]);function f(){let e={page:c.value};return i.params&&(e={...e,...i.params}),e}async function w({done:e}){try{if(!i.apipath)return;if(u.value){e("ok");return}if(u.value=!0,p()){if(t.value=await k.get(i.apipath,{params:f()}),o.value=!0,t.value.length===0){e("ok");return}a.value=[...a.value,...t.value],c.value++}else for(;!p();){if(t.value=await k.get(i.apipath,{params:f()}),o.value=!0,t.value.length===0){e("ok");return}a.value=[...a.value,...t.value],c.value++}u.value=!1,e("ok")}catch(_){console.error(_),e("error")}}return(e,_)=>{const C=b("VInfiniteScroll");return r(),l(h,null,[n(o)?d("",!0):(r(),l("div",D,[v(L,{size:"48",indeterminate:"",color:"primary"})])),v(C,{mode:"intersect",side:"end",items:n(a),class:"overflow-hidden",onLoad:w},{loading:g(()=>[]),default:g(()=>[n(a).length>0?(r(),l("div",H,[(r(!0),l(h,null,B(n(a),m=>(r(),x(M,{key:m.tmdb_id||m.douban_id,media:m},null,8,["media"]))),128))])):d("",!0),n(a).length===0&&n(o)?(r(),x(S,{key:1,"error-code":"404","error-title":"没有数据","error-description":"无法获取到TMDB媒体信息。"})):d("",!0)]),_:1},8,["items"])],64)}}});export{N as _};
