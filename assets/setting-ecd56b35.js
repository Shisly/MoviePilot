import{d as q,r as C,af as J,M as ye,q as Q,e as pe,o as b,c as F,m as e,i as t,C as R,z as T,A as W,W as be,j as a,a as l,I,V as B,a0 as oe,P as le,B as N,D as Y,E as P,J as v,f as A,O as ee,a4 as ue,L as H,U as G,t as L,a3 as se,Q as he,R as xe,ac as we,a1 as Ve,$ as re,X as ie,_ as X,G as Ce,H as Se,K as fe,aH as te,az as j,a7 as me,aa as D,N as ae,ab as _e,aI as ke,as as ve,al as $e,b as Re,aJ as Ue,aK as Ie,aL as De,aM as z,T as K}from"./index-9b9cd080.js";import{r as ce}from"./index-705cb9e8.js";import{a as S}from"./index-0c6df641.js";import{a as de}from"./avatar-1-4acd3e19.js";import{_ as ge}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-a33069ed.js";import{c as Fe}from"./index-d2c33d5a.js";const Le={class:"d-flex flex-column justify-center gap-5"},Te={class:"d-flex flex-wrap gap-2"},Ae=l("span",{class:"d-none d-sm-block"},"上传头像",-1),Ee=l("span",{class:"d-none d-sm-block"},"重置",-1),Be=l("p",{class:"text-body-1 mb-0"}," 允许 JPG、GIF 或 PNG 格式， 最大尺寸 800K。 ",-1),Pe=l("thead",null,[l("tr",null,[l("th",{scope:"col"}," 用户名 "),l("th",{scope:"col"}," 邮箱 "),l("th",{scope:"col"}," 状态 "),l("th",{scope:"col"}," 管理员 "),l("th",{scope:"col",class:"w-5"})])],-1),He=q({__name:"AccountSettingAccount",setup(M){const d=C(!1),s=C(!1),p=C(!1),f=C(""),_=C(""),x=J.useToast(),w=C(),$=C(!1),h=ye({name:"",password:"",email:""}),g=C({id:0,name:"",password:"",email:"",is_active:!1,is_superuser:!1,avatar:""}),k=C([]);function E(u){const r=new FileReader,{files:U}=u.target;U&&U.length>0&&(r.readAsDataURL(U[0]),r.onload=()=>{typeof r.result=="string"&&(g.value.avatar=r.result,i())})}function O(){g.value.avatar=de}async function y(){try{const u=await S.get("user/current");g.value=u,g.value.avatar||(g.value.avatar=de)}catch(u){console.log(u)}}async function i(){if(f.value||_.value){if(f.value!==_.value){x.error("两次输入的密码不一致");return}g.value.password=f.value}try{const u=await S.put("user/",g.value);u.success?x.success("用户信息保存成功！"):x.error(`用户信息保存失败：${u.message}！`)}catch(u){console.log(u)}}async function m(){try{const u=await S.get("/user/");k.value=u}catch(u){console.log(u)}}async function n(u){try{const r=await S.delete(`user/${u.name}`);r.success?(x.success("用户删除成功！"),m()):x.error(`用户删除失败：${r.message}！`)}catch(r){console.log(r)}}async function c(u){try{u.is_active=!u.is_active;const r=await S.put("user/",u);r.success?(x.success("用户冻结成功！"),m()):x.error(`用户冻结失败：${r.message}！`)}catch(r){console.log(r)}}async function o(){try{const u=await S.post("user",h);u.success?(x.success("用户新增成功！"),m(),$.value=!1):x.error(`用户新增失败：${u.message}！`)}catch(u){console.log(u)}}return Q(()=>{y(),m()}),(u,r)=>{const U=pe("IconBtn");return b(),F(H,null,[e(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"个人信息"},{default:t(()=>[e(W,{class:"d-flex"},{default:t(()=>[e(be,{rounded:"lg",size:"100",class:"me-6",image:a(g).avatar},null,8,["image"]),l("form",Le,[l("div",Te,[e(I,{color:"primary",onClick:r[0]||(r[0]=V=>{var Z;return(Z=a(w))==null?void 0:Z.click()})},{default:t(()=>[e(B,{icon:"mdi-cloud-upload-outline",class:"d-sm-none"}),Ae]),_:1}),l("input",{ref_key:"refInputEl",ref:w,type:"file",name:"file",accept:".jpeg,.png,.jpg,GIF",hidden:"",onInput:E},null,544),e(I,{type:"reset",color:"error",variant:"tonal",onClick:O},{default:t(()=>[Ee,e(B,{icon:"mdi-refresh",class:"d-sm-none"})]),_:1})]),Be])]),_:1}),e(oe),e(W,null,{default:t(()=>[e(le,{class:"mt-6"},{default:t(()=>[e(N,null,{default:t(()=>[e(R,{md:"6",cols:"12"},{default:t(()=>[e(Y,{modelValue:a(g).name,"onUpdate:modelValue":r[1]||(r[1]=V=>a(g).name=V),readonly:"",label:"用户名"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(g).email,"onUpdate:modelValue":r[2]||(r[2]=V=>a(g).email=V),label:"邮箱",type:"email"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(f),"onUpdate:modelValue":r[3]||(r[3]=V=>P(f)?f.value=V:null),type:a(d)?"text":"password","append-inner-icon":a(d)?"mdi-eye-off-outline":"mdi-eye-outline",label:"新密码",autocomplete:"new-password","onClick:appendInner":r[4]||(r[4]=V=>d.value=!a(d))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(_),"onUpdate:modelValue":r[5]||(r[5]=V=>P(_)?_.value=V:null),type:a(s)?"text":"password","append-inner-icon":a(s)?"mdi-eye-off-outline":"mdi-eye-outline",label:"确认新密码","onClick:appendInner":r[6]||(r[6]=V=>s.value=!a(s))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),e(R,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:t(()=>[e(I,{onClick:i},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(g).is_superuser?(b(),A(R,{key:0,cols:"12"},{default:t(()=>[e(T,{title:"所有用户"},{append:t(()=>[e(U,{onClick:r[7]||(r[7]=ee(V=>$.value=!0,["stop"]))},{default:t(()=>[e(B,{icon:"mdi-plus"})]),_:1})]),default:t(()=>[e(ue,{class:"text-no-wrap"},{default:t(()=>[Pe,l("tbody",null,[(b(!0),F(H,null,G(a(k),V=>(b(),F("tr",{key:V.name},[l("td",null,L(V.name),1),l("td",null,L(V.email),1),l("td",null,[V.is_active?(b(),A(se,{key:0,color:"success","text-color":"white"},{default:t(()=>[v(" 激活 ")]),_:1})):(b(),A(se,{key:1,color:"error","text-color":"white"},{default:t(()=>[v(" 冻结 ")]),_:1}))]),l("td",null,L(V.is_superuser?"是":"否"),1),l("td",null,[he(e(U,null,{default:t(()=>[e(B,{icon:"mdi-dots-vertical"}),e(we,{activator:"parent","close-on-content-click":""},{default:t(()=>[e(Ve,null,{default:t(()=>[e(re,{variant:"plain",onClick:Z=>c(V)},{prepend:t(()=>[e(B,{icon:"mdi-lock"})]),default:t(()=>[e(ie,null,{default:t(()=>[v(L(V.is_active?"冻结":"解冻"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(re,{variant:"plain","base-color":"error",onClick:Z=>n(V)},{prepend:t(()=>[e(B,{icon:"mdi-delete"})]),default:t(()=>[e(ie,null,{default:t(()=>[v("删除")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1536),[[xe,a(g).is_superuser&&a(g).name!=V.name]])])]))),128))])]),_:1})]),_:1})]),_:1})):X("",!0)]),_:1}),e(fe,{modelValue:a($),"onUpdate:modelValue":r[13]||(r[13]=V=>P($)?$.value=V:null),"max-width":"50rem",persistent:""},{default:t(()=>[e(T,{title:"新增用户"},{default:t(()=>[e(W,null,{default:t(()=>[e(le,{onSubmit:ee(()=>{},["prevent"])},{default:t(()=>[e(N,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(h).name,"onUpdate:modelValue":r[8]||(r[8]=V=>a(h).name=V),label:"用户名",rules:[a(ce)]},null,8,["modelValue","rules"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(h).password,"onUpdate:modelValue":r[9]||(r[9]=V=>a(h).password=V),label:"密码",rules:[a(ce)],type:a(p)?"text":"password","append-inner-icon":a(p)?"mdi-eye-off-outline":"mdi-eye-outline","onClick:appendInner":r[10]||(r[10]=V=>p.value=!a(p))},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(h).email,"onUpdate:modelValue":r[11]||(r[11]=V=>a(h).email=V),label:"邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(Ce,null,{default:t(()=>[e(I,{onClick:r[12]||(r[12]=V=>$.value=!1)},{default:t(()=>[v(" 取消 ")]),_:1}),e(Se),e(I,{onClick:o},{default:t(()=>[v(" 确定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Me=l("thead",null,[l("tr",null,[l("th",{scope:"col"}," 消息类型 "),l("th",{scope:"col"}," 微信 "),l("th",{scope:"col"}," Telegram "),l("th",{scope:"col"}," Slack "),l("th",{scope:"col"}," SynologyChat ")])],-1),je={key:0},Ne=l("td",{colspan:"4",class:"text-center"}," 没有设置任何通知渠道 ",-1),qe=[Ne],Oe={class:"d-flex flex-wrap gap-4 mt-4"},We=q({__name:"AccountSettingNotification",setup(M){const d=C([]),s=J.useToast();async function p(){try{const _=await S.get("message/switchs");d.value=_}catch(_){console.log(_)}}async function f(){try{(await S.post("message/switchs",d.value)).success?s.success("保存通知消息设置成功"):s.error("保存通知消息设置失败！")}catch(_){console.log(_)}}return Q(()=>{p()}),(_,x)=>(b(),A(T,{title:"消息通知"},{default:t(()=>[e(W,null,{default:t(()=>[v(" 对应消息类型只会发送给选中的消息渠道。 ")]),_:1}),e(ue,{class:"text-no-wrap"},{default:t(()=>[Me,l("tbody",null,[(b(!0),F(H,null,G(a(d),w=>(b(),F("tr",{key:w.mtype},[l("td",null,L(w.mtype),1),l("td",null,[e(te,{modelValue:w.wechat,"onUpdate:modelValue":$=>w.wechat=$},null,8,["modelValue","onUpdate:modelValue"])]),l("td",null,[e(te,{modelValue:w.telegram,"onUpdate:modelValue":$=>w.telegram=$},null,8,["modelValue","onUpdate:modelValue"])]),l("td",null,[e(te,{modelValue:w.slack,"onUpdate:modelValue":$=>w.slack=$},null,8,["modelValue","onUpdate:modelValue"])]),l("td",null,[e(te,{modelValue:w.synologychat,"onUpdate:modelValue":$=>w.synologychat=$},null,8,["modelValue","onUpdate:modelValue"])])]))),128)),a(d).length===0?(b(),F("tr",je,qe)):X("",!0)])]),_:1}),e(oe),e(W,null,{default:t(()=>[e(le,{onSubmit:ee(()=>{},["prevent"])},{default:t(()=>[l("div",Oe,[e(I,{mtype:"submit",onClick:f},{default:t(()=>[v(" 保存 ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1})]),_:1}))}}),Ge=q({__name:"AccountSettingRule",setup(M){const d=J.useToast(),s=C("seeder"),p=[{title:"站点优先",value:"site"},{title:"做种数优先",value:"seeder"}],f=C({include:"",exclude:""});async function _(){var h;try{const g=await S.get("system/setting/TorrentsPriority");s.value=(h=g.data)==null?void 0:h.value}catch(g){console.log(g)}}async function x(){var h,g;try{const k=await S.get("system/setting/DefaultFilterRules");(h=k.data)!=null&&h.value&&(f.value=(g=k.data)==null?void 0:g.value)}catch(k){console.log(k)}}async function w(){try{(await S.post("system/setting/TorrentsPriority",s.value)).success?d.success("优先规则保存成功"):d.error("优先规则保存失败！")}catch(h){console.log(h)}}async function $(){try{(await S.post("system/setting/DefaultFilterRules",f.value)).success?d.success("默认包含/排除规则保存成功"):d.error("默认包含/排除规则保存失败！")}catch(h){console.log(h)}}return Q(()=>{_(),x()}),(h,g)=>(b(),A(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"下载优先规则"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 按站点优先级或资源种子数量排序和择优下载。 ")]),_:1}),e(W,null,{default:t(()=>[e(le,null,{default:t(()=>[e(N,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(me,{modelValue:a(s),"onUpdate:modelValue":g[0]||(g[0]=k=>P(s)?s.value=k:null),items:p,label:"优先规则",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:w},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"默认过滤规则"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 设置在搜索和订阅时默认使用的过滤规则。 ")]),_:1}),e(W,null,{default:t(()=>[e(le,null,{default:t(()=>[e(N,null,{default:t(()=>[e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(f).include,"onUpdate:modelValue":g[1]||(g[1]=k=>a(f).include=k),type:"text",label:"包含（关键字、正则式）"},null,8,["modelValue"])]),_:1}),e(R,{cols:"12",md:"6"},{default:t(()=>[e(Y,{modelValue:a(f).exclude,"onUpdate:modelValue":g[2]||(g[2]=k=>a(f).exclude=k),type:"text",label:"排除（关键字、正则式）"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:$},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const ze=q({__name:"AccountSettingSite",setup(M){const d=J.useToast(),s=C(!1),p=C("重置站点数据"),f=C(!1);async function _(){try{f.value=!0,p.value="正在重置...",(await S.get("site/reset")).success?d.success("站点重置成功，请等待CookieCloud同步完成！"):d.error("站点重置失败！"),f.value=!1,p.value="重置站点数据"}catch(x){console.log(x)}}return(x,w)=>(b(),A(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"站点重置"},{default:t(()=>[e(W,null,{default:t(()=>[l("div",null,[e(te,{modelValue:a(s),"onUpdate:modelValue":w[0]||(w[0]=$=>P(s)?s.value=$:null),label:"确认删除所有站点数据并重新同步。"},null,8,["modelValue"])]),e(I,{disabled:!a(s)||a(f),color:"error",class:"mt-3",onClick:_},{default:t(()=>[v(L(a(p)),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ke=q({__name:"AccountSettingWords",setup(M){const d=J.useToast(),s=C(""),p=C(""),f=C(""),_=C("");async function x(){var y;try{const i=await S.get("system/setting/CustomIdentifiers");s.value=(y=i.data)==null?void 0:y.value.join(`
`)}catch(i){console.log(i)}}async function w(){var y;try{const i=await S.get("system/setting/CustomReleaseGroups");p.value=(y=i.data)==null?void 0:y.value.join(`
`)}catch(i){console.log(i)}}async function $(){var y;try{const i=await S.get("system/setting/Customization");f.value=(y=i.data)==null?void 0:y.value.join(`
`)}catch(i){console.log(i)}}async function h(){var y;try{const i=await S.get("system/setting/TransferExcludeWords");_.value=(y=i.data)==null?void 0:y.value.join(`
`)}catch(i){console.log(i)}}async function g(){try{(await S.post("system/setting/CustomIdentifiers",s.value.split(`
`))).success?d.success("自定义识别词保存成功"):d.error("自定义识别词保存失败！")}catch(y){console.log(y)}}async function k(){try{(await S.post("system/setting/CustomReleaseGroups",p.value.split(`
`))).success?d.success("自定义制作组/字幕组保存成功"):d.error("自定义制作组/字幕组保存失败！")}catch(y){console.log(y)}}async function E(){try{(await S.post("system/setting/Customization",f.value.split(`
`))).success?d.success("自定义占位符保存成功"):d.error("自定义占位符保存失败！")}catch(y){console.log(y)}}async function O(){try{(await S.post("system/setting/TransferExcludeWords",_.value.split(`
`))).success?d.success("文件整理屏蔽词保存成功"):d.error("文件整理屏蔽词保存失败！")}catch(y){console.log(y)}}return Q(()=>{x(),w(),$(),h()}),(y,i)=>(b(),A(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"自定义识别词"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 添加规则对种子名或者文件名进行预处理以校正识别。 ")]),_:1}),e(D,null,{default:t(()=>[e(ae,{modelValue:a(s),"onUpdate:modelValue":i[0]||(i[0]=m=>P(s)?s.value=m:null),"auto-grow":"",placeholder:`支持正则表达式，特殊字符需要\\转义，一行为一组，支持以下几种配置格式：
屏蔽词
被替换词 => 替换词
前定位词 <> 后定位词 >> 集偏移量（EP）
被替换词 => 替换词 && 前定位词 <> 后定位词 >> 集偏移量（EP）`},null,8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:g},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"自定义制作组/字幕组"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 添加无法识别的制作组/字幕组。 ")]),_:1}),e(D,null,{default:t(()=>[e(ae,{modelValue:a(p),"onUpdate:modelValue":i[1]||(i[1]=m=>P(p)?p.value=m:null),"auto-grow":"",placeholder:"支持正则表达式，特殊字符需要\\转义，一行代表一个制作组/字幕组"},null,8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:k},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"自定义占位符"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 添加自定义占位符识别正则，重命名格式中添加{customization}使用。 ")]),_:1}),e(D,null,{default:t(()=>[e(ae,{modelValue:a(f),"onUpdate:modelValue":i[2]||(i[2]=m=>P(f)?f.value=m:null),"auto-grow":"",placeholder:"多个匹配对象请换行分隔，支持正则表达式，特殊字符注意转义"},null,8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:E},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"文件整理屏蔽词"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 目录名或文件名中包含屏蔽词时不进行整理。 ")]),_:1}),e(D,null,{default:t(()=>[e(ae,{modelValue:a(_),"onUpdate:modelValue":i[3]||(i[3]=m=>P(_)?_.value=m:null),"auto-grow":"",placeholder:"支持正则表达式，特殊字符需要\\转义，一行代表一个屏蔽词"},null,8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:O},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ye={class:"px-3"},Xe={class:"section"},Je=l("div",null,[l("h3",{class:"heading"}," 关于 MoviePilot ")],-1),Qe={class:"section border-t border-gray-800"},Ze={class:"max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"},et=l("dt",{class:"block text-sm font-bold"}," 当前版本 ",-1),tt={class:"flex text-sm sm:col-span-2 sm:mt-0"},lt={class:"flex-grow flex flex-row items-center truncate"},st={class:"truncate"},at={key:0,href:"https://github.com/jxxghp/MoviePilot/releases",target:"_blank",rel:"noopener noreferrer"},nt=l("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full whitespace-nowrap bg-green-500 bg-opacity-80 border border-green-500 !text-green-100 ml-2 !cursor-pointer transition hover:bg-green-400"}," 最新 ",-1),ot=[nt],ut={class:"max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"},rt=l("dt",{class:"block text-sm font-bold"}," 配置目录 ",-1),it={class:"flex text-sm sm:col-span-2 sm:mt-0"},ct={class:"flex-grow undefined"},dt=l("div",{class:"max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"},[l("dt",{class:"block text-sm font-bold"}," 数据目录 "),l("dd",{class:"flex text-sm sm:col-span-2 sm:mt-0"},[l("span",{class:"flex-grow undefined"},[l("code",null,"/moviepilot")])])],-1),pt={class:"max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"},ft=l("dt",{class:"block text-sm font-bold"}," 时区 ",-1),mt={class:"flex text-sm sm:col-span-2 sm:mt-0"},_t={class:"flex-grow undefined"},vt=ke('<div class="section"><div><h3 class="heading"> 支援 </h3></div><div class="section border-t border-gray-800"><dl><div><div class="max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"><dt class="block text-sm font-bold"> 文档 </dt><dd class="flex text-sm sm:col-span-2 sm:mt-0"><span class="flex-grow undefined"><a href="https://github.com/jxxghp/MoviePilot/blob/main/README.md" target="_blank" rel="noreferrer" class="text-indigo-500 transition duration-300 hover:underline"> https://github.com/jxxghp/MoviePilot/blob/main/README.md </a></span></dd></div></div><div><div class="max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"><dt class="block text-sm font-bold"> 问题反馈 </dt><dd class="flex text-sm sm:col-span-2 sm:mt-0"><span class="flex-grow undefined"><a href="https://github.com/jxxghp/MoviePilot/issues/new/choose" target="_blank" rel="noreferrer" class="text-indigo-500 transition duration-300 hover:underline"> https://github.com/jxxghp/MoviePilot/issues/new/choose </a></span></dd></div></div><div><div class="max-w-6xl py-4 sm:grid sm:grid-cols-3 sm:gap-4"><dt class="block text-sm font-bold"> 发布频道 </dt><dd class="flex text-sm sm:col-span-2 sm:mt-0"><span class="flex-grow undefined"><a href="https://t.me/moviepilot_channel" target="_blank" rel="noreferrer" class="text-indigo-500 transition duration-300 hover:underline"> https://t.me/moviepilot_channel </a></span></dd></div></div></dl></div></div>',1),gt={class:"section"},yt=l("h3",{class:"heading"}," 软件版本 ",-1),bt={class:"section space-y-3"},ht={class:"flex w-full flex-grow items-center justify-start space-x-2 truncate sm:justify-start"},xt={class:"truncate text-lg font-bold"},wt={class:"mr-2 whitespace-nowrap text-xs font-normal"},Vt={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full whitespace-nowrap cursor-default bg-green-500 bg-opacity-80 border border-green-500 !text-green-100"},Ct={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full whitespace-nowrap cursor-default bg-indigo-500 bg-opacity-80 border border-indigo-500 !text-indigo-100"},St=q({__name:"AccountSettingAbout",setup(M){const d=C({}),s=C([]),p=C(!1),f=C(""),_=C(""),x=C("");function w(k,E){_.value=k,x.value=E.replaceAll(`\r
`,"<br />"),p.value=!0}async function $(){try{const k=await S.get("system/env");d.value=k.data}catch(k){console.log(k)}}async function h(){try{const k=await S.get("system/versions");s.value=k.data??[],s.value.length>0&&(f.value=s.value[0].tag_name)}catch(k){console.log(k)}}function g(k){return`${Fe(k)}前`}return Q(()=>{$(),h()}),(k,E)=>{const O=ge;return b(),F(H,null,[l("div",Ye,[l("div",Xe,[Je,l("div",Qe,[l("dl",null,[l("div",null,[l("div",Ze,[et,l("dd",tt,[l("span",lt,[l("code",st,L(a(d).VERSION),1),a(f)===a(d).VERSION?(b(),F("a",at,ot)):X("",!0)])])])]),l("div",null,[l("div",ut,[rt,l("dd",it,[l("span",ct,[l("code",null,L(a(d).CONFIG_DIR),1)])])]),dt]),l("div",null,[l("div",pt,[ft,l("dd",mt,[l("span",_t,[l("code",null,L(a(d).TZ),1)])])])])])])]),vt,l("div",gt,[l("div",null,[yt,l("div",bt,[l("div",null,[(b(!0),F(H,null,G(a(s),y=>(b(),F("div",{key:y.tag_name,class:"mb-3 flex w-full flex-col space-y-3 rounded-md px-4 py-2 shadow-md ring-1 ring-gray-400 sm:flex-row sm:space-y-0 sm:space-x-3"},[l("div",ht,[l("span",xt,[l("span",wt,L(g(y.published_at)),1),v(" "+L(y.tag_name),1)]),y.tag_name===a(f)?(b(),F("span",Vt," 最新软件版本 ")):X("",!0),y.tag_name===a(d).VERSION?(b(),F("span",Ct," 当前版本 ")):X("",!0)]),e(I,{onClick:ee(i=>w(y.tag_name,y.body),["stop"])},{prepend:t(()=>[e(B,{icon:"mdi-text-box-outline"})]),default:t(()=>[v(" 查看变更日志 ")]),_:2},1032,["onClick"])]))),128))])])])])]),e(fe,{modelValue:a(p),"onUpdate:modelValue":E[1]||(E[1]=y=>P(p)?p.value=y:null),width:"600",scrollable:""},{default:t(()=>[e(T,null,{default:t(()=>[e(D,null,{default:t(()=>[e(O,{onClick:E[0]||(E[0]=y=>p.value=!1)}),e(_e,null,{default:t(()=>[v(L(a(_))+" 变更日志",1)]),_:1})]),_:1}),e(W,{innerHTML:a(x)},null,8,["innerHTML"])]),_:1})]),_:1},8,["modelValue"])],64)}}});const kt={class:"absolute top-3 right-14"},ne=q({__name:"FilterRuleCard",props:{pri:String,maxpri:String,rules:Array,width:String,height:String},emits:["close","changed","levelup","leveldown"],setup(M,{emit:d}){const s=M;function p(){d("close")}function f(){d("levelup",s.pri)}function _(){d("leveldown",s.pri)}function x($){d("changed",s.pri,$)}const w=C([{title:"特效字幕",value:" SPECSUB "},{title:"中文字幕",value:" CNSUB "},{title:"国语配音",value:" CNVOI "},{title:"排除: 国语配音",value:" !CNVOI "},{title:"粤语配音",value:" HKVOI "},{title:"排除: 粤语配音",value:" !HKVOI "},{title:"促销: 免费",value:" FREE "},{title:"分辨率: 4K",value:" 4K "},{title:"分辨率: 1080P",value:" 1080P "},{title:"分辨率: 720P",value:" 720P "},{title:"排除: 720P",value:" !720P "},{title:"质量: 蓝光原盘",value:" BLU "},{title:"排除: 蓝光原盘",value:" !BLU "},{title:"质量: BLURAY",value:" BLURAY "},{title:"排除: BLURAY",value:" !BLURAY "},{title:"质量: UHD",value:" UHD "},{title:"排除: UHD",value:" !UHD "},{title:"质量: REMUX",value:" REMUX "},{title:"排除: REMUX",value:" !REMUX "},{title:"质量: WEB-DL",value:" WEBDL "},{title:"排除: WEB-DL",value:" !WEBDL "},{title:"质量: 60fps",value:" 60FPS "},{title:"排除: 60fps",value:" !60FPS "},{title:"编码: H265",value:" H265 "},{title:"排除: H265",value:" !H265 "},{title:"编码: H264",value:" H264 "},{title:"排除: H264",value:" !H264 "},{title:"效果: 杜比视界",value:" DOLBY "},{title:"排除: 杜比视界",value:" !DOLBY "},{title:"效果: 杜比全景声",value:" ATMOS "},{title:"排除: 杜比全景声",value:" !ATMOS "},{title:"效果: HDR",value:" HDR "},{title:"排除: HDR",value:" !HDR "},{title:"效果: SDR",value:" SDR "},{title:"排除: SDR",value:" !SDR "},{title:"效果: 3D",value:" 3D "},{title:"排除: 3D",value:" !3D "}]);return($,h)=>{const g=pe("IconBtn"),k=ge;return b(),A(T,{variant:"tonal",width:s.width,height:s.height},{default:t(()=>[l("span",kt,[s.pri!=="1"?(b(),A(g,{key:0,onClick:ee(f,["stop"])},{default:t(()=>[e(B,{icon:"mdi-arrow-up"})]),_:1},8,["onClick"])):X("",!0),s.pri!==s.maxpri?(b(),A(g,{key:1,onClick:ee(_,["stop"])},{default:t(()=>[e(B,{icon:"mdi-arrow-down"})]),_:1},8,["onClick"])):X("",!0)]),e(k,{onClick:p}),e(D,null,{default:t(()=>[e(_e,null,{default:t(()=>[v("优先级 "+L(s.pri),1)]),_:1}),e(N,null,{default:t(()=>[e(R,null,{default:t(()=>[(b(),A(me,{key:s.pri,modelValue:s.rules,"onUpdate:modelValue":[h[0]||(h[0]=E=>s.rules=E),x],variant:"underlined",items:a(w),chips:"",label:"",multiple:""},null,8,["modelValue","items"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["width","height"])}}}),$t={class:"grid gap-3 grid-filterrule-card"},Rt=q({__name:"AccountSettingSearch",setup(M){const d=J.useToast(),s=C([]),p=C([]),f=C([]);async function _(){var i,m;try{const n=await S.get("system/setting/SearchFilterRules");if(n.success){const c=((m=(i=n.data)==null?void 0:i.value)==null?void 0:m.split(">"))??[];s.value=c==null?void 0:c.map((o,u)=>({pri:(u+1).toString(),rules:o.split("&")}))}}catch(n){console.log(n)}}async function x(){try{let i="";s.value.length!==0&&(i=s.value.filter(n=>n.rules.length>0).map(n=>n.rules.join("&")).join(">")),(await S.post("system/setting/SearchFilterRules",i)).success?d.success("搜索优先级保存成功"):d.error("搜索优先级保存失败！")}catch(i){console.log(i)}}function w(i,m){const n=s.value.find(c=>c.pri===i);n&&(n.rules=m)}function $(i){const m=s.value.filter(n=>n.pri!==i).map((n,c)=>(n.pri=(c+1).toString(),n));s.value=m}function h(){const m={pri:(s.value.length+1).toString(),rules:[]};s.value.push(m)}async function g(){try{const i=await S.get("site/");p.value=i.filter(m=>m.is_active),k()}catch(i){console.log(i)}}async function k(){var i;try{const m=await S.get("system/setting/IndexerSites");f.value=((i=m.data)==null?void 0:i.value)??[]}catch(m){console.log(m)}}async function E(){try{(await S.post("system/setting/IndexerSites",f.value)).success?d.success("搜索站点保存成功"):d.error("搜索站点保存失败！")}catch(i){console.log(i)}}function O(i){const m=s.value.find(o=>o.pri===i);if(!m)return;const n=s.value.find(o=>o.pri===(parseInt(i)-1).toString());if(!n)return;const c=m.pri;m.pri=n.pri,n.pri=c,s.value.sort((o,u)=>parseInt(o.pri)-parseInt(u.pri))}function y(i){const m=s.value.find(o=>o.pri===i);if(!m)return;const n=s.value.find(o=>o.pri===(parseInt(i)+1).toString());if(!n)return;const c=m.pri;m.pri=n.pri,n.pri=c,s.value.sort((o,u)=>parseInt(o.pri)-parseInt(u.pri))}return Q(()=>{_(),g()}),(i,m)=>(b(),A(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"搜索站点"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 只有选中的站点才会在搜索中使用。")]),_:1}),e(D,null,{default:t(()=>[e(ve,{modelValue:a(f),"onUpdate:modelValue":m[0]||(m[0]=n=>P(f)?f.value=n:null),column:"",multiple:""},{default:t(()=>[(b(!0),F(H,null,G(a(p),n=>(b(),A(se,{key:n.id,color:a(f).includes(n.id)?"primary":"",filter:"",variant:"outlined",value:n.id},{default:t(()=>[v(L(n.name),1)]),_:2},1032,["color","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:E},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"搜索优先级"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 设置在搜索时默认使用的优先级排序，未在优先级中的资源将不在搜索结果中显示。 ")]),_:1}),e(D,null,{default:t(()=>[l("div",$t,[(b(!0),F(H,null,G(a(s),(n,c)=>(b(),A(ne,{key:c,pri:n.pri,maxpri:a(s).length.toString(),rules:n.rules,onChanged:w,onClose:o=>$(n.pri),onLeveldown:y,onLevelup:O},null,8,["pri","maxpri","rules","onClose"]))),128))])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",class:"me-2",onClick:m[1]||(m[1]=n=>x())},{default:t(()=>[v(" 保存 ")]),_:1}),e(I,{color:"success",variant:"tonal",onClick:m[2]||(m[2]=n=>h())},{default:t(()=>[e(B,{icon:"mdi-plus"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const Ut={class:"grid gap-3 grid-filterrule-card"},It={class:"grid gap-3 grid-filterrule-card"},Dt=q({__name:"AccountSettingSubscribe",setup(M){const d=J.useToast(),s=C([]),p=C([]),f=C([]),_=C([]);async function x(){var n;try{const c=await S.get("system/setting/RssSites");_.value=((n=c.data)==null?void 0:n.value)??[]}catch(c){console.log(c)}}async function w(){try{(await S.post("system/setting/RssSites",_.value)).success?d.success("订阅站点保存成功"):d.error("订阅站点保存失败！")}catch(n){console.log(n)}}async function $(){try{const n=await S.get("site/");f.value=n.filter(c=>c.is_active),x()}catch(n){console.log(n)}}async function h(n){var c,o;try{const u=await S.get(`system/setting/${n}`);if(u.success){const r=((o=(c=u.data)==null?void 0:c.value)==null?void 0:o.split(">"))??[],U=n==="SubscribeFilterRules"?s:p;U.value=r==null?void 0:r.map((V,Z)=>({pri:(Z+1).toString(),rules:V.split("&")}))}}catch(u){console.log(u)}}async function g(n){try{let c="";const o=n==="SubscribeFilterRules"?s:p;o.value.length!==0&&(c=o.value.filter(U=>U.rules.length>0).map(U=>U.rules.join("&")).join(">"));const u=await S.post(`system/setting/${n}`,c),r=n==="SubscribeFilterRules"?"订阅优先级":"洗版优先级";u.success?d.success(`${r}保存成功`):d.error(`${r}保存失败！`)}catch(c){console.log(c)}}function k(n,c){const o=s.value.find(u=>u.pri===n);o&&(o.rules=c)}function E(n,c){const o=p.value.find(u=>u.pri===n);o&&(o.rules=c)}function O(n,c){const o=(n==="SubscribeFilterRules"?s.value:p.value).filter(u=>u.pri!==c).map((u,r)=>(u.pri=(r+1).toString(),u));n==="SubscribeFilterRules"?s.value=o:p.value=o}function y(n){const c=n==="SubscribeFilterRules"?s:p,u={pri:(c.value.length+1).toString(),rules:[]};c.value.push(u)}function i(n,c){const o=n.find(U=>U.pri===c);if(!o)return;const u=n.find(U=>U.pri===(parseInt(c)-1).toString());if(!u)return;const r=o.pri;o.pri=u.pri,u.pri=r,n.sort((U,V)=>parseInt(U.pri)-parseInt(V.pri))}function m(n,c){const o=n.find(U=>U.pri===c);if(!o)return;const u=n.find(U=>U.pri===(parseInt(c)+1).toString());if(!u)return;const r=o.pri;o.pri=u.pri,u.pri=r,n.sort((U,V)=>parseInt(U.pri)-parseInt(V.pri))}return Q(()=>{$(),h("SubscribeFilterRules"),h("BestVersionFilterRules")}),(n,c)=>(b(),A(N,null,{default:t(()=>[e(R,{cols:"12"},{default:t(()=>[e(T,{title:"订阅站点"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 只有选中的站点才会在订阅中使用。")]),_:1}),e(D,null,{default:t(()=>[e(ve,{modelValue:a(_),"onUpdate:modelValue":c[0]||(c[0]=o=>P(_)?_.value=o:null),column:"",multiple:""},{default:t(()=>[(b(!0),F(H,null,G(a(f),o=>(b(),A(se,{key:o.id,color:a(_).includes(o.id)?"primary":"",filter:"",variant:"outlined",value:o.id},{default:t(()=>[v(L(o.name),1)]),_:2},1032,["color","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",onClick:w},{default:t(()=>[v(" 保存 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"订阅优先级"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 设置在正常订阅时默认使用的优先级，未在优先级中的资源将不会自动下载。 ")]),_:1}),e(D,null,{default:t(()=>[l("div",Ut,[(b(!0),F(H,null,G(a(s),(o,u)=>(b(),A(ne,{key:u,pri:o.pri,maxpri:a(s).length.toString(),rules:o.rules,onChanged:k,onClose:r=>O("SubscribeFilterRules",o.pri),onLeveldown:r=>m(a(s),o.pri),onLevelup:r=>i(a(s),o.pri)},null,8,["pri","maxpri","rules","onClose","onLeveldown","onLevelup"]))),128))])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",class:"me-2",onClick:c[1]||(c[1]=o=>g("SubscribeFilterRules"))},{default:t(()=>[v(" 保存 ")]),_:1}),e(I,{color:"success",variant:"tonal",onClick:c[2]||(c[2]=o=>y("SubscribeFilterRules"))},{default:t(()=>[e(B,{icon:"mdi-plus"})]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{cols:"12"},{default:t(()=>[e(T,{title:"洗版优先级"},{default:t(()=>[e(j,null,{default:t(()=>[v(" 设置在订阅洗版时使用的优先级，匹配优先级1时洗版完成。 ")]),_:1}),e(D,null,{default:t(()=>[l("div",It,[(b(!0),F(H,null,G(a(p),(o,u)=>(b(),A(ne,{key:u,pri:o.pri,maxpri:a(p).length.toString(),rules:o.rules,onChanged:E,onClose:r=>O("BestVersionFilterRules",o.pri),onLeveldown:r=>m(a(p),o.pri),onLevelup:r=>i(a(p),o.pri)},null,8,["pri","maxpri","rules","onClose","onLeveldown","onLevelup"]))),128))])]),_:1}),e(D,null,{default:t(()=>[e(I,{type:"submit",class:"me-2",onClick:c[3]||(c[3]=o=>g("BestVersionFilterRules"))},{default:t(()=>[v(" 保存 ")]),_:1}),e(I,{color:"success",variant:"tonal",onClick:c[4]||(c[4]=o=>y("BestVersionFilterRules"))},{default:t(()=>[e(B,{icon:"mdi-plus"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const Ft=l("thead",null,[l("tr",null,[l("th",{scope:"col"}," 任务名称 "),l("th",{scope:"col"}," 任务状态 "),l("th",{scope:"col"}," 下一次执行时间 "),l("th",{scope:"col"})])],-1),Lt={key:0},Tt=l("td",{colspan:"4",class:"text-center"}," 没有后台服务 ",-1),At=[Tt],Et=q({__name:"AccountSettingService",setup(M){const d=J.useToast(),s=C([]);let p=null;async function f(){try{const w=await S.get("dashboard/schedule");s.value=w}catch(w){console.log(w)}}function _(w){switch(w){case"正在运行":return"success";case"已停止":return"error";case"等待":return"";default:return""}}function x(w){try{S.get("system/runscheduler",{params:{jobid:w}}),d.success("定时作业执行请求提交成功！"),setTimeout(()=>{f()},1e3)}catch($){console.log($)}}return Q(()=>{f(),p=setInterval(()=>{f()},5e3)}),$e(()=>{p&&(clearInterval(p),p=null)}),(w,$)=>(b(),A(T,{title:"定时作业"},{default:t(()=>[e(W,null,{default:t(()=>[v(" 手动执行不会影响作业正常的时间表。 ")]),_:1}),e(ue,{class:"text-no-wrap"},{default:t(()=>[Ft,l("tbody",null,[(b(!0),F(H,null,G(a(s),h=>(b(),F("tr",{key:h.id},[l("td",null,L(h.name),1),l("td",null,[e(se,{color:_(h.status)},{default:t(()=>[v(L(h.status),1)]),_:2},1032,["color"])]),l("td",null,L(h.next_run),1),l("td",null,[e(I,{size:"small",disabled:h.status==="正在运行",onClick:g=>x(h.id)},{prepend:t(()=>[e(B,null,{default:t(()=>[v("mdi-play")]),_:1})]),default:t(()=>[v(" 执行 ")]),_:2},1032,["disabled","onClick"])])]))),128)),a(s).length===0?(b(),F("tr",Lt,At)):X("",!0)])]),_:1})]),_:1}))}}),qt=q({__name:"setting",setup(M){const d=Re(),s=C(d.params.tab),p=[{title:"用户",icon:"mdi-account",tab:"account"},{title:"站点",icon:"mdi-web",tab:"site"},{title:"搜索",icon:"mdi-magnify",tab:"search"},{title:"订阅",icon:"mdi-rss",tab:"subscribe"},{title:"服务",icon:"mdi-list-box",tab:"service"},{title:"规则",icon:"mdi-filter-cog",tab:"filter"},{title:"通知",icon:"mdi-bell",tab:"notification"},{title:"词表",icon:"mdi-file-word-box",tab:"words"},{title:"关于",icon:"mdi-information",tab:"about"}];return(f,_)=>(b(),F("div",null,[e(Ue,{modelValue:a(s),"onUpdate:modelValue":_[0]||(_[0]=x=>P(s)?s.value=x:null),"show-arrows":""},{default:t(()=>[(b(),F(H,null,G(p,x=>e(De,{key:x.icon,value:x.tab},{default:t(()=>[e(B,{size:"20",start:"",icon:x.icon},null,8,["icon"]),v(" "+L(x.title),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),e(oe),e(Ie,{modelValue:a(s),"onUpdate:modelValue":_[1]||(_[1]=x=>P(s)?s.value=x:null),class:"mt-5 disable-tab-transition",touch:!1},{default:t(()=>[e(z,{value:"account"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(He)]),_:1})]),_:1}),e(z,{value:"site"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(ze)]),_:1})]),_:1}),e(z,{value:"search"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(Rt)]),_:1})]),_:1}),e(z,{value:"subscribe"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(Dt)]),_:1})]),_:1}),e(z,{value:"service"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(Et)]),_:1})]),_:1}),e(z,{value:"filter"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(Ge)]),_:1})]),_:1}),e(z,{value:"notification"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(We)]),_:1})]),_:1}),e(z,{value:"words"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(Ke)]),_:1})]),_:1}),e(z,{value:"about"},{default:t(()=>[e(K,{name:"fade-slide",appear:""},{default:t(()=>[e(St)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});export{qt as default};
