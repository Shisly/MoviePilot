import{_ as O}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-5fa15fd8.js";import{d as T,r as n,af as I,av as q,o as b,f as v,i as s,K as F,m as t,A as L,P as N,O as W,B as m,C as i,D as d,j as l,_ as D,a7 as c,aB as K,G as M,I as x,J as C,H as P,z as j}from"./index-1d8de1d3.js";import{n as H}from"./index-705cb9e8.js";import{a as f}from"./index-1bb05dc5.js";const X=T({__name:"SubscribeEditForm",props:{subid:Number},emits:["remove","save","close"],setup(w,{emit:V}){const r=w,p=n([]),y=n([]),e=n({id:r.subid??0,keyword:"",quality:"",resolution:"",effect:"",include:"",exclude:"",total_episode:0,start_episode:0,best_version:0,sites:[],type:"",name:"",year:"",tmdbid:0,state:"",last_update:"",username:"",current_priority:0}),_=I.useToast();async function B(){try{const u=await f.put("subscribe/",e.value);u.success?(_.success(`${e.value.name} 更新成功！`),V("save")):_.error(`${e.value.name} 更新失败：${u.message}！`)}catch(u){console.log(u)}}async function R(){try{const u=await f.get("site/rss");p.value=u.filter(a=>a.is_active)}catch(u){console.error(u)}}async function S(){p.value.length||await R();const u=p.value.map(a=>({title:a.name,value:a.id}));y.value=u.flat()}async function U(){try{const u=await f.get(`subscribe/${r.subid}`);e.value=u,e.value.best_version=e.value.best_version===1}catch(u){console.log(u)}}async function g(){try{(await f.delete(`subscribe/${r.subid}`)).success&&V("remove")}catch(u){console.log(u)}}const k=n([{title:"全部",value:""},{title:"蓝光原盘",value:"Blu-?Ray.+VC-?1|Blu-?Ray.+AVC|UHD.+blu-?ray.+HEVC|MiniBD"},{title:"Remux",value:"Remux"},{title:"BluRay",value:"Blu-?Ray"},{title:"UHD",value:"UHD|UltraHD"},{title:"WEB-DL",value:"WEB-?DL|WEB-?RIP"},{title:"HDTV",value:"HDTV"},{title:"H265",value:"[Hx].?265|HEVC"},{title:"H264",value:"[Hx].?264|AVC"}]),$=n([{title:"全部",value:""},{title:"4k",value:"4K|2160p|x2160"},{title:"1080p",value:"1080[pi]|x1080"},{title:"720p",value:"720[pi]|x720"}]),E=n([{title:"全部",value:""},{title:"杜比视界",value:"Dolby[\\s.]+Vision|DOVI|[\\s.]+DV[\\s.]+"},{title:"杜比全景声",value:"Dolby[\\s.]*\\+?Atmos|Atmos"},{title:"HDR",value:"[\\s.]+HDR[\\s.]+|HDR10|HDR10\\+"},{title:"SDR",value:"[\\s.]+SDR[\\s.]+"}]);return q(()=>{r.subid&&(S(),U())}),(u,a)=>{const A=O;return b(),v(F,{scrollable:"","max-width":"60rem"},{default:s(()=>[t(j,{title:`编辑订阅 - ${l(e).name} ${l(e).season?`第 ${l(e).season} 季`:""}`,class:"rounded-t"},{default:s(()=>[t(L,{class:"pt-2"},{default:s(()=>[t(A,{onClick:a[0]||(a[0]=o=>V("close"))}),t(N,{onSubmit:W(()=>{},["prevent"])},{default:s(()=>[t(m,null,{default:s(()=>[t(i,{cols:"12",md:"8"},{default:s(()=>[t(d,{modelValue:l(e).keyword,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).keyword=o),label:"搜索关键词"},null,8,["modelValue"])]),_:1}),l(e).type==="电视剧"?(b(),v(i,{key:0,cols:"12",md:"2"},{default:s(()=>[t(d,{modelValue:l(e).total_episode,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).total_episode=o),label:"总集数",rules:[l(H)]},null,8,["modelValue","rules"])]),_:1})):D("",!0),l(e).type==="电视剧"?(b(),v(i,{key:1,cols:"12",md:"2"},{default:s(()=>[t(d,{modelValue:l(e).start_episode,"onUpdate:modelValue":a[3]||(a[3]=o=>l(e).start_episode=o),label:"开始集数",rules:[l(H)]},null,8,["modelValue","rules"])]),_:1})):D("",!0)]),_:1}),t(m,null,{default:s(()=>[t(i,{cols:"12",md:"4"},{default:s(()=>[t(c,{modelValue:l(e).quality,"onUpdate:modelValue":a[4]||(a[4]=o=>l(e).quality=o),label:"质量",items:l(k)},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(c,{modelValue:l(e).resolution,"onUpdate:modelValue":a[5]||(a[5]=o=>l(e).resolution=o),label:"分辨率",items:l($)},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(c,{modelValue:l(e).effect,"onUpdate:modelValue":a[6]||(a[6]=o=>l(e).effect=o),label:"特效",items:l(E)},null,8,["modelValue","items"])]),_:1})]),_:1}),t(m,null,{default:s(()=>[t(i,{cols:"12",md:"4"},{default:s(()=>[t(d,{modelValue:l(e).include,"onUpdate:modelValue":a[7]||(a[7]=o=>l(e).include=o),label:"包含（关键字、正则式）"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(d,{modelValue:l(e).exclude,"onUpdate:modelValue":a[8]||(a[8]=o=>l(e).exclude=o),label:"排除（关键字、正则式）"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",md:"4"},{default:s(()=>[t(c,{modelValue:l(e).sites,"onUpdate:modelValue":a[9]||(a[9]=o=>l(e).sites=o),items:l(y),chips:"",label:"订阅站点",multiple:""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(m,null,{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[t(K,{modelValue:l(e).best_version,"onUpdate:modelValue":a[10]||(a[10]=o=>l(e).best_version=o),label:"洗版"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(M,null,{default:s(()=>[t(x,{color:"error",onClick:g},{default:s(()=>[C(" 取消订阅 ")]),_:1}),t(P),t(x,{variant:"tonal",onClick:B},{default:s(()=>[C(" 保存 ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})}}});export{X as _};
